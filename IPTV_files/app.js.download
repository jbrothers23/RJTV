document.addEventListener('contextmenu', event => event.preventDefault());
document.addEventListener('DOMContentLoaded', function() {
	const video = document.getElementById('drm-player');
	const searchBar = document.getElementById('search-bar');
	const channelsList = document.getElementById('channels');
	const uiContainer = document.getElementById('video-ott');
	document.addEventListener('DOMContentLoaded', (event) => {
		const openButton = document.getElementById('open-button');
		const sidebar = document.getElementById('sidebar');
		let inactivityTimer;
		let lastActivityTime = Date.now();
		const resetInactivityTimer = () => {
			lastActivityTime = Date.now();
			clearTimeout(inactivityTimer);
			inactivityTimer = setTimeout(() => {
				if (Date.now() - lastActivityTime >= 5000) {
					sidebar.classList.remove('open');
					openButton.style.display = 'block'
				}
			}, 5000)
		};
		const openSidebar = () => {
			sidebar.classList.add('open');
			openButton.style.display = 'none';
			resetInactivityTimer()
		};
		openButton.addEventListener('click', openSidebar);
		['mousemove', 'click', 'keypress'].forEach(eventType => {
			sidebar.addEventListener(eventType, resetInactivityTimer)
		})
	});
	const devtools = () => {
		const threshold = 160;
		const widthThreshold = window.outerWidth - window.innerWidth > threshold;
		const heightThreshold = window.outerHeight - window.innerHeight > threshold;
		if (widthThreshold || heightThreshold) {
			window.location.href = 'https://rjtvmorante.netlify.app/'
		}
	};
	devtools();
	window.addEventListener('resize', devtools);
	document.documentElement.addEventListener('click', function() {
		if (!document.fullscreenElement) {
			document.documentElement.requestFullscreen().catch(err => {})
		}
	});

	function checkOrientation() {
		if (window.innerHeight > window.innerWidth) {
			document.getElementById('container-ott').classList.remove('ott')
		} else {
			document.getElementById('container-ott').classList.add('ott')
		}
	}
	window.addEventListener('resize', checkOrientation);
	window.addEventListener('load', checkOrientation);
	const streams = {

			a2z: {
			name: 'A2Z',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_a2z/default/index.mpd',
			licensekey: 'f703e4c8ec9041eeb5028ab4248fa094:c22f2162e176eee6273a5d0b68d19530',
		},

			abcaustralia: {
			name: 'ABC Australia',
			manifestUri: 'https://qp-pldt-live-grp-10-prod.akamaized.net/out/u/dr_abc_aus.mpd',
			licensekey: '389497f9f8584a57b234e27e430e04b7:3b85594c7f88604adf004e45c03511c0',
		},

			animalplanetXXX: {
			name: 'ANIMAL PLANET (NOT WORKING)',
			manifestUri: 'https://qp-pldt-live-grp-02-prod.akamaized.net/out/u/cg_animal_planet_sd.mpd',
			licensekey: '436b69f987924fcbbc06d40a69c2799a:c63d5b0d7e52335b61aeba4f6537d54d',
		},

			animax: {
			name: 'ANIMAX',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_animax_sd_new/default/index.mpd',
			licensekey: '92032b0e41a543fb9830751273b8debd:03f8b65e2af785b10d6634735dbe6c11',
		},

			animexhidive: {
			name: 'ANI X HIDIVE',
			manifestUri: 'https://amc-anime-x-hidive-1-us.tablo.wurl.tv/playlist.m3u8',
		},

			anione: {
			name: 'ANI ONE',
			manifestUri: 'https://amg19223-amg19223c9-amgplt0019.playout.now3.amagi.tv/playlist/amg19223-amg19223c9-amgplt0019/playlist.m3u8',	
		},

			aniplus: {
			name: 'ANI PLUS',
			manifestUri: 'https://amg18481-amg18481c1-amgplt0352.playout.now3.amagi.tv/playlist/amg18481-amg18481c1-amgplt0352/playlist.m3u8',	
		},

			anc: {
			name: 'ANC',
			manifestUri: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-anc-global-dash-abscbnono/index.mpd',
			licensekey: '4bbdc78024a54662854b412d01fafa16:6039ec9b213aca913821677a28bd78ae',
		},

			aljazeera: {
			name: 'AL JAZEERA',
			manifestUri: 'https://live-hls-web-aje.getaj.net/AJE/index.m3u8',
		},

			axn: {
			name: 'AXN',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_axn_sd/default/index.mpd',
			licensekey: 'fd5d928f5d974ca4983f6e9295dfe410:3aaa001ddc142fedbb9d5557be43792f',
		},

			bbcearth: {
			name: 'BBC EARTH',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_bbcearth_hd1/default/index.mpd',
			licensekey: '34ce95b60c424e169619816c5181aded:0e2a2117d705613542618f58bf26fc8e',
		},

			billiardtv: {
			name: 'BILLIARD TV',
			manifestUri: 'https://1b29dd71cd5e4191a3eb26afff631ed3.mediatailor.us-west-2.amazonaws.com/v1/master/9d062541f2ff39b5c0f48b743c6411d25f62fc25/SportsTribal-BilliardTV/BILLIARDTV_SCTE.m3u8',
		},

			Bilyonaryo: {
			name: 'BBC EARTH',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/bilyonaryoch/default/index.mpd',
			licensekey: '227ffaf09bec4a889e0e0988704d52a2:b2d0dce5c486891997c1c92ddaca2cd2',
		},

			blastmovies: {
			name: 'BLAST MOVIES',
			manifestUri: 'https://amg19223-amg19223c7-amgplt0351.playout.now3.amagi.tv/playlist/amg19223-amg19223c7-amgplt0351/playlist.m3u8',
		},

			Blastports: {
			name: 'BLAST SPORT',
			manifestUri: 'https://amg19223-amg19223c1-amgplt0351.playout.now3.amagi.tv/playlist/amg19223-amg19223c1-amgplt0351/playlist.m3u8',
		},

			Bloomberg: {
			name: 'BLOOMBERG',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/bloomberg_sd/default/index.mpd',
			licensekey: 'ef7d9dcfb99b406cb79fb9f675cba426:b24094f6ca136af25600e44df5987af4',
		},


			buko: {
			name: 'BUKO',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/cg_buko_sd/default/index.mpd',
			licensekey: 'd273c085f2ab4a248e7bfc375229007d:7932354c3a84f7fc1b80efa6bcea0615',
		},


			Cartoonnetwork: {
			name: 'CARTOON NETWORK',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cartoonnetworkhd/default/index.mpd',
			licensekey: 'a2d1f552ff9541558b3296b5a932136b:cdd48fa884dc0c3a3f85aeebca13d444',
		},


			CartoonClassics: {
			name: 'CARTOON CLASSICS',
			manifestUri: 'https://streams2.sofast.tv/v1/master/611d79b11b77e2f571934fd80ca1413453772ac7/d5543c06-5122-49a7-9662-32187f48aa2c/manifest.m3u8',
		},

			CelestialmoviesPinoy: {
			name: 'CELESTIAL MOVIES PINOY',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/celmovie_pinoy_sd/default/index.mpd',
			licensekey: '0f8537d8412b11edb8780242ac120002:2ffd7230416150fd5196fd7ea71c36f3',
		},

			cbsnewsdetroit: {
			name: 'cbs news detroit',
			manifestUri: 'https://cbsn-det.cbsnstream.cbsnews.com/out/v1/169f5c001bc74fa7a179b19c20fea069/master.m3u8',
		},

			Cinemaone: {
			name: 'CINEMA ONE',
			manifestUri: 'https://d9rpesrrg1bdi.cloudfront.net/out/v1/93b9db7b231d45f28f64f29b86dc6c65/index.mpd',
			licensekey: '58d0e56991194043b8fb82feb4db7276:d68f41b59649676788889e19fb10d22c',
		},

			Cinemo: {
			name: 'CINEMO',
			manifestUri: 'https://d1bail49udbz1k.cloudfront.net/out/v1/3a895f368f4a467c9bca0962559efc19/index.mpd',
			licensekey: 'aa8aebe35ccc4541b7ce6292efcb1bfb:aab1df109d22fc5d7e3ec121ddf24e5f',
		},

			Cinemax: {
			name: 'CINEMAX',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_cinemax/default/index.mpd',
			licensekey: 'b207c44332844523a3a3b0469e5652d7:fe71aea346db08f8c6fbf0592209f955',
		},

			Cctv4XXX: {
			name: 'CCTV4XXX',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_cctv4/default/index.mpd',
			licensekey: '0f8541ec412b11edb8780242ac120002:6cf16c272b7357c48cd47061799a4963',
		},

			ChannelNewsAsia: {
			name: 'Channel News Asia',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/channelnewsasia/default/index.mpd',
			licensekey: 'b259df9987364dd3b778aa5d42cb9acd:753e3dba96ab467e468269e7e33fb813',
		},

			cnninternational: {
			name: 'CNN INTERNATIONAL',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_cnnhd/default/index.mpd',
			licensekey: '900c43f0e02742dd854148b7a75abbec:da315cca7f2902b4de23199718ed7e90',
		},

			CRIMEINVESTIGATION: {
			name: 'CRIME INVESTIGATION',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/crime_invest/default/index.mpd',
			licensekey: '21e2843b561c4248b8ea487986a16d33:db6bb638ccdfc1ad1a3e98d728486801',
		},

			DepEdchannel: {
			name: 'DepEd Channel',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/depedch_sd/default/index.mpd',
			licensekey: '0f853706412b11edb8780242ac120002:2157d6529d80a760f60a8b5350dbc4df',
		},

			discoveryasiaXXX: {
			name: 'DISCOVERY ASIA (NOT WORKING)',
			manifestUri: 'https://pull-hls-live.jr365m.cc/stream/astromalaysia/discoveryasia/master.m3u8',
		},

			DiscoveryChannel: {
			name: 'Discovery Channel',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/discovery/default/index.mpd',
			licensekey: 'd9ac48f5131641a789328257e778ad3a:b6e67c37239901980c6e37e0607ceee6',
		},

			DisneyChannelXXX: {
			name: 'Disney Channel (NOT WORKING)',
			manifestUri: 'https://uselector.cdn.intigral-ott.net/DIS/DIS.isml/manifest.mpd',
			licensekey: '72800c62fcf2bfbedd9af27d79ed35d6:b6ccb9facb2c1c81ebe4dfaab8a45195',
		},

			DisneyjrXXX: {
			name: 'Disney (NOT WORKING)',
			manifestUri: 'https://uselector.cdn.intigral-ott.net/DJR/DJR.isml/manifest.mpd',
			licensekey: 'f5df57914a0922d5d5ed6b0a4af6290a:c62b10a180d1770a355b3c4cb6506ca0',
		},

			DisneyXDXXX: {
			name: 'Disney (NOT WORKING)',
			manifestUri: 'https://fl5.moveonjoy.com/DISNEY_XD/index.m3u8',
		},

			DreamworksHD: {
			name: 'Dreamworks HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_dreamworks_hd1/default/index.mpd',
			licensekey: '4ab9645a2a0a47edbd65e8479c2b9669:8cb209f1828431ce9b50b593d1f44079',
		},

			DreamworksTagalog: {
			name: 'Dreamworks Tagalog',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_dreamworktag/default/index.mpd',
			licensekey: '564b3b1c781043c19242c66e348699c5:d3ad27d7fe1f14fb1a2cd5688549fbab',
		},

			ESPN: {
			name: 'ESPN',
			manifestUri: 'https://gtv.fflame143.workers.dev/stream.m3u8',
		},

			FashionTVHD: {
			name: 'Fashion TV HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/fashiontvhd/default/index.mpd',
			licensekey: '971ebbe2d887476398e97c37e0c5c591:472aa631b1e671070a4bf198f43da0c7',
		},

			FoodNetworkHD: {
			name: 'Food Network HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_foodnetwork_hd1/default/index.mpd',
			licensekey: 'b7299ea0af8945479cd2f287ee7d530e:b8ae7679cf18e7261303313b18ba7a14',
		},

			GlobalTrekker: {
			name: 'Global Trekker',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/globaltrekker/default/index.mpd',
			licensekey: '5c26c24bce2942078cf6e35216632c2d:445887a1c0832ff457263d8bcadc993f',
		},

			GMA: {
			name: 'GMA (NOT WORKING)',
			manifestUri: 'https://www.youtube.com/embed/live_stream?channel=UCKL5hAuzgFQsyrsQKgU0Qng',
		},

			GMAPinoyTV: {
			name: 'GMA Pinoy TV',
			manifestUri: 'https://cdn-uw2-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-abscbn-gma-x7-dash-abscbnono/7c693236-e0c1-40a3-8bd0-bb25e43f5bfc/index.mpd',
			licensekey: 'c95ed4c44b0b4f7fa1c6ebbbbaab21a1:47635b8e885e19f2ccbdff078c207058',
		},

			GlobalFashionChannel: {
			name: 'Global Fashion Channel',
			manifestUri: 'https://gfcomnimedia-globalfashionchannel-1-eu.xiaomi.wurl.tv/playlist.m3u8',
		},

			hallypop: {
			name: 'hallypop',
			manifestUri: 'https://jungotvstream.chanall.tv/jungotv/hallypop/stream.m3u8',
		},

			HBOFamily: {
			name: 'HBO Family',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbofam/default/index.mpd',
			licensekey: '872910c843294319800d85f9a0940607:f79fd895b79c590708cf5e8b5c6263be',
		},

			HBOHits: {
			name: 'HBO Hits',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbohits/default/index.mpd',
			licensekey: 'b04ae8017b5b4601a5a0c9060f6d5b7d:a8795f3bdb8a4778b7e888ee484cc7a1',
		},


			HBOSignature: {
			name: 'HBO Signature',
			manifestUri: '"https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbosign/default/index.mpd',
			licensekey: 'a06ca6c275744151895762e0346380f5:559da1b63eec77b5a942018f14d3f56f',
		},

			HBOFamily: {
			name: 'HBO Family',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbofam/default/index.mpd',
			licensekey: '872910c843294319800d85f9a0940607:f79fd895b79c590708cf5e8b5c6263be',
		},


			HBOHD: {
			name: 'HBO HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hbohd/default/index.mpd',
			licensekey: 'd47ebabf7a21430b83a8c4b82d9ef6b1:54c213b2b5f885f1e0290ee4131d425b',
		},

			HGTVHD: {
			name: 'HGTV HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/hgtv_hd1/default/index.mpd',
			licensekey: 'f0e3ab943318471abc8b47027f384f5a:13802a79b19cc3485d2257165a7ef62a',
		},

			HistoryHD: {
			name: 'History HD',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_historyhd/default/index.mpd',
			licensekey: 'a7724b7ca2604c33bb2e963a0319968a:6f97e3e2eb2bade626e0281ec01d3675',
		},

			HitsHD: {
			name: 'Hits HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/hits_hd1/default/index.mpd',
			licensekey: 'dac605bc197e442c93f4f08595a95100:975e27ffc1b7949721ee3ccb4b7fd3e5',
		},

			HitsNow: {
			name: 'Hits Now',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/cg_hitsnow/default/index.mpd',
			licensekey: '14439a1b7afc4527bb0ebc51cf11cbc1:92b0287c7042f271b266cc11ab7541f1',
		},

			IBC13: {
			name: 'IBC13',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/ibc13_sd_new/default1/index.mpd',
			licensekey: '04e292bc99bd4ccba89e778651914254:ff0a62bdf8920ce453fe680330b563a5',
		},

			INCTV: {
			name: 'INCTV',
			manifestUri: 'https://199211.global.ssl.fastly.net/643cc12aa824db4374021c8c/live_95f6ac80dd6511ed9d08b12be56ae55e/index.m3u8',
		},

			IQIYI: {
			name: 'IQIYI',
			manifestUri: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/1006/default_ott.mpd',
			licensekey: '7ef7e913ce85a1131b27036069169a10:77d98ed71db7524c27875a09a975f9e6',
		},

			JeepneyTV: {
			name: 'Jeepney TV',
			manifestUri: 'https://abslive.akamaized.net/dash/live/2028025/jeepneytv/manifest.mpd',
			licensekey: '90ea4079e02f418db7b170e8763e65f0:1bfe2d166e31d03eee86ee568bd6c272',
		},

			JungoPinoytv: {
			name: 'Jungo Pinoy tv',
			manifestUri: 'https://jungotvstream.chanall.tv/jungotv/jungopinoytv/stream.m3u8',
		},

			KapamilyaChannel: {
			name: 'Kapamilya Channel',
			manifestUri: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/index.mpd',
			licensekey: 'bd17afb5dc9648a39be79ee3634dd4b8:3ecf305d54a7729299b93a3d69c02ea5',
		},

			JeepneyTV: {
			name: 'Jeepney TV',
			manifestUri: 'https://abslive.akamaized.net/dash/live/2028025/jeepneytv/manifest.mpd',
			licensekey: '90ea4079e02f418db7b170e8763e65f0:1bfe2d166e31d03eee86ee568bd6c272',
		},

			KapamilyaChannel: {
			name: 'Kapamilya Channel',
			manifestUri: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/index.mpd',
			licensekey: 'bd17afb5dc9648a39be79ee3634dd4b8:3ecf305d54a7729299b93a3d69c02ea5',
		},

			KapamilyaOnline: {
			name: 'Kapamilya Online',
			manifestUri: 'https://www.youtube.com/embed/live_stream?channel=UCstEtN0pgOmCf02EdXsGChw',
		},

			KBSWorld: {
			name: 'KBS World',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/kbsworld/default/index.mpd',
			licensekey: '22ff2347107e4871aa423bea9c2bd363:c6e7ba2f48b3a3b8269e8bc360e60404',
		},

			KixHD: {
			name: 'Kix HD',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/kix_hd1/default/index.mpd',
			licensekey: 'a8d5712967cd495ca80fdc425bc61d6b:f248c29525ed4c40cc39baeee9634735',
		},

			KnowledgeChannel: {
			name: 'Knowledge Channel',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/knowledge_channel/default/index.mpd',
			licensekey: '0f856fa0412b11edb8780242ac120002:783374273ef97ad3bc992c1d63e091e7',
		},

			KPlus: {
			name: 'KPlus',
			manifestUri: 'https://linearjitp-playback.astro.com.my/dash-wv/linear/9983/default_ott.mpd',
			licensekey: 'aa48b28bd723f91214887df6ed9fad10:b5a3a800848120c843ae0fa68c09c261',
		},

			Lifetime: {
			name: 'Lifetime',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/dr_lifetime/default/index.mpd',
			licensekey: 'cf861d26e7834166807c324d57df5119:64a81e30f6e5b7547e3516bbf8c647d0',
		},

			KMovies: {
			name: 'K-Movies',
			manifestUri: 'https://7732c5436342497882363a8cd14ceff4.mediatailor.us-east-1.amazonaws.com/v1/master/04fd913bb278d8775298c26fdca9d9841f37601f/Plex_NewMovies/playlist.m3u8',
		},

			LotusMacau: {
			name: 'Lotus Macau',
			manifestUri: 'https://qp-pldt-live-bpk-01-prod.akamaized.net/bpk-tv/lotusmacau_prd/default/index.mpd',
			licensekey: '60dc692e64ea443a8fb5ac186c865a9b:01bdbe22d59b2a4504b53adc2f606cc1',
		},

			MovieSphere: {
			name: 'Movie Sphere',
			manifestUri: 'https:\\jmp2.uk\rok-b5cde121f98257329346020e2a60295a.m3u8',
		},








			tv5hd: {
			name: 'TV5 HD',
			manifestUri: 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/tv5_hd/default1/index.mpd',
			licensekey: '2615129ef2c846a9bbd43a641c7303ef:07c7f996b1734ea288641a68e1cfdc4d',
},




	};
	const loadingOverlay = document.createElement('div');
	loadingOverlay.id = 'loading-overlay';
	loadingOverlay.style.position = 'absolute';
	loadingOverlay.style.top = '0';
	loadingOverlay.style.left = '0';
	loadingOverlay.style.width = '100%';
	loadingOverlay.style.height = '100%';
	loadingOverlay.style.backgroundColor = 'rgba(43, 51, 63, 0.7)';
	loadingOverlay.style.display = 'flex';
	loadingOverlay.style.justifyContent = 'center';
	loadingOverlay.style.alignItems = 'center';
	loadingOverlay.innerHTML = `<div class="circular-progress"><div class="circle"><div class="mask full"><div class="fill"></div></div><div class="mask half"><div class="fill"></div><div class="fill fix"></div></div></div><div class="inside-circle">Loading...</div></div>`;
	uiContainer.appendChild(loadingOverlay);
	const progressBarStyle = document.createElement('style');
	progressBarStyle.innerHTML = ``;
	document.head.appendChild(progressBarStyle);
	video.controls = false;
	const player = new gowatch.Player(video);
	video.addEventListener('pause', function() {
		video.play()
	});
	player.addEventListener('buffering', function(event) {
		if (event.buffering) {
			loadingOverlay.style.display = 'flex';
			startProgress()
		} else {
			loadingOverlay.style.display = 'none';
			stopProgress()
		}
	});
	player.addEventListener('error', onErrorEvent);
	let progressInterval;
	let progress = 0;

	function startProgress() {
		const progressBar = document.querySelector('.circular-progress .circle');
		const progressText = document.querySelector('.circular-progress .inside-circle');
		progressInterval = setInterval(() => {
			if (progress < 100) {
				progress += 1;
				const degree = (progress / 100) * 360;
				if (progress <= 50) {
					progressBar.querySelector('.mask.full').style.transform = `rotate(${degree}deg)`
				} else {
					progressBar.querySelector('.mask.full').style.transform = 'rotate(180deg)';
					progressBar.querySelector('.mask.half .fill').style.transform = `rotate(${degree-180}deg)`
				}
				progressText.innerText = `${progress}%`
			} else {
				clearInterval(progressInterval)
			}
		}, 50)
	}

	function stopProgress() {
		clearInterval(progressInterval);
		progress = 0;
		const progressBar = document.querySelector('.circular-progress .circle');
		const progressText = document.querySelector('.circular-progress .inside-circle');
		progressBar.querySelector('.mask.full').style.transform = 'rotate(0deg)';
		progressBar.querySelector('.mask.half .fill').style.transform = 'rotate(0deg)';
		progressText.innerText = '0%'
	}
	async function loadStream(stream) {
		let drmConfig = {
			servers: {},
			advanced: {
				'com.widevine.alpha': {
					videoRobustness: "SW_SECURE_CRYPTO",
					audioRobustness: "SW_SECURE_CRYPTO",
				}
			}
		};
		if (stream.licenseserver) {
			drmConfig.servers['com.widevine.alpha'] = stream.licenseserver
		}
		if (stream.licensekey) {
			const [licensekeyId, licensekeyValue] = stream.licensekey.split(':');
			drmConfig.drmkeys = {
				[licensekeyId]: licensekeyValue,
			}
		}
		player.configure({
			streaming: {
				abr: {
					enabled: false
				}
			},
			drm: drmConfig
		});
		if (stream.manifestUri.endsWith('.mpd')) {
			player.getNetworkingEngine().clearAllRequestFilters();
			player.getNetworkingEngine().registerRequestFilter((type, request) => {
				if (type === gowatch.net.NetworkingEngine.RequestType.SEGMENT) {
					const bandwidth = stream.bandwidth;
					request.allowCrossSiteCredentials = false;
					request.uris = request.uris.map(uri => uri + `?bandwidth=${bandwidth}`)
				}
			})
		} else {
			player.getNetworkingEngine().clearAllRequestFilters()
		}
		try {
			await player.load(stream.manifestUri)
		} catch (error) {
			onError(error)
		}
	}
	async function preloadStream(stream) {}

	function preloadAllStreams() {
		for (const licensekey in streams) {
			if (streams.hasOwnProperty(licensekey)) {
				preloadStream(streams[licensekey])
			}
		}
	}

	function populateChannelList() {
		channelsList.innerHTML = '';
		for (const licensekey in streams) {
			if (streams.hasOwnProperty(licensekey)) {
				const stream = streams[licensekey];
				const listItem = document.createElement('li');
				listItem.textContent = stream.name;
				listItem.addEventListener('click', () => loadStream(stream));
				channelsList.appendChild(listItem)
			}
		}
	}

	function onErrorEvent(event) {
		onError(event.detail)
	}

	function onError(error) {}
	searchBar.addEventListener('input', function(event) {
		const query = event.target.value.toLowerCase();
		channelsList.innerHTML = '';
		for (const licensekey in streams) {
			if (streams.hasOwnProperty(licensekey) && streams[licensekey].name.toLowerCase().includes(query)) {
				const stream = streams[licensekey];
				const listItem = document.createElement('li');
				listItem.textContent = stream.name;
				listItem.addEventListener('click', () => loadStream(stream));
				channelsList.appendChild(listItem)
			}
		}
	});
	preloadAllStreams();
	populateChannelList();
	loadStream(streams.Cartoonnetwork);
	const resolutionButton = document.createElement('button');
	resolutionButton.innerHTML = '<i class="fa fa-cog" style="color:yellow;"></i>';
	resolutionButton.style.position = 'absolute';
	resolutionButton.style.bottom = '40px';
	resolutionButton.style.right = '40px';
	resolutionButton.style.zIndex = '1001';
	resolutionButton.style.backgroundColor = 'rgba(255, 255, 255, 0)';
	resolutionButton.style.border = 'none';
	resolutionButton.style.fontSize = '24px';
	resolutionButton.style.cursor = 'pointer';
	uiContainer.appendChild(resolutionButton);
	const resolutionMenu = document.createElement('div');
	resolutionMenu.style.position = 'absolute';
	resolutionMenu.style.bottom = '40px';
	resolutionMenu.style.right = '20px';
	resolutionMenu.style.backgroundColor = 'rgba(43, 51, 63, 0.7)';
	resolutionMenu.style.color = '#fff';
	resolutionMenu.style.border = 'none';
	resolutionMenu.style.display = 'none';
	resolutionMenu.style.zIndex = '1001';
	uiContainer.appendChild(resolutionMenu);
	let timeoutId;

	function closeResolutionMenu() {
		resolutionMenu.style.display = 'none';
		resolutionButton.style.display = 'block';
		clearTimeout(timeoutId)
	}
	resolutionButton.addEventListener('click', () => {
		if (resolutionMenu.style.display === 'none') {
			resolutionMenu.style.display = 'block';
			resolutionButton.style.display = 'none';
			timeoutId = setTimeout(closeResolutionMenu, 5000)
		} else {
			closeResolutionMenu()
		}
	});

	function updateResolutions() {
		const tracks = player.getVariantTracks();
		const uniqueHeights = [...new Set(tracks.map(track => track.height))];
		const currentTrack = player.getVariantTracks().find(track => track.active);
		resolutionMenu.innerHTML = '';
		uniqueHeights.forEach(height => {
			const resOption = document.createElement('div');
			resOption.style.display = 'flex';
			resOption.style.alignItems = 'center';
			resOption.style.padding = '5px';
			resOption.style.cursor = 'pointer';
			const resText = document.createElement('span');
			resText.innerText = `${height}p`;
			const checkIcon = document.createElement('i');
			checkIcon.className = 'fa fa-check';
			checkIcon.style.marginLeft = '10px';
			checkIcon.style.visibility = currentTrack && currentTrack.height === height ? 'visible' : 'hidden';
			resOption.appendChild(resText);
			resOption.appendChild(checkIcon);
			resOption.addEventListener('click', () => {
				changeResolution(height);
				closeResolutionMenu()
			});
			resolutionMenu.appendChild(resOption)
		});
		const autoOption = document.createElement('div');
		autoOption.style.display = 'flex';
		autoOption.style.alignItems = 'center';
		autoOption.style.padding = '5px';
		autoOption.style.cursor = 'pointer';
		const autoText = document.createElement('span');
		autoText.innerText = 'Auto';
		const checkIconAuto = document.createElement('i');
		checkIconAuto.className = 'fa fa-check';
		checkIconAuto.style.marginLeft = '10px';
		checkIconAuto.style.visibility = currentTrack && !currentTrack.height ? 'visible' : 'hidden';
		autoOption.appendChild(autoText);
		autoOption.appendChild(checkIconAuto);
		autoOption.addEventListener('click', () => {
			changeResolution('Auto');
			closeResolutionMenu()
		});
		resolutionMenu.appendChild(autoOption)
	}

	function changeResolution(res) {
		const tracks = player.getVariantTracks();
		let selectedTrack = tracks[0];
		if (res !== 'Auto') {
			selectedTrack = tracks.find(track => track.height === res) || selectedTrack
		}
		player.selectVariantTrack(selectedTrack, true);
		player.configure({
			abr: {
				enabled: res === 'Auto'
			}
		});
		updateResolutions()
	}
	player.addEventListener('trackschanged', updateResolutions);
	updateResolutions()
});
